{"ast":null,"code":"var _jsxFileName = \"/Users/bradwilliams/EatSafely/client/src/pages/scan_result.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport \"./scan_result.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ScanResult(_ref) {\n  _s();\n  let {\n    ocrState,\n    confidence,\n    intolerances,\n    backButton,\n    progress,\n    loading\n  } = _ref;\n  const [matches, setMatches] = useState([]);\n\n  // useEffect(() => {\n  //   findMatches(intolerances, ocrState.text)\n  // }, [findMatches]);\n\n  function findMatches(intolerances, str) {\n    let matches = [];\n    let newStr = \"\";\n    let validChars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\n    let intoleranceArray = intolerances.split(\", \");\n    for (let i = 0; i < str.length; i++) {\n      let char = str[i];\n      if (validChars.indexOf(char) !== -1) {\n        newStr += char;\n      }\n    }\n    let strArray = newStr.split(\" \");\n    // console.log(`find matches: newStr ${newStr}`);\n    // console.log(`find matches: strArray ${strArray}`);\n    // console.log(`find matches: strArray ${typeof strArray}`);\n    // console.log(`find matches: intolerances - ${intoleranceArray}`)\n    // console.log(`find matches: intolerances - ${typeof intoleranceArray}`)\n\n    for (let i = 0; i < intoleranceArray.length; i++) {\n      for (let j = 0; j < strArray.length; j++) {\n        if (intoleranceArray[i] === strArray[j]) {\n          matches.push(intoleranceArray[i]);\n          break;\n        }\n      }\n    }\n    setMatches(matches);\n    return matches;\n  }\n  function highlightText(intolerances, str) {\n    // take out punctuation\n    let newStr = \"\";\n    const validChars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ \";\n    // /[A-Z]\\i/\n\n    for (let i = 0; i < str.length; i++) {\n      let char = str[i];\n      if (validChars.indexOf(char) !== -1) {\n        newStr += char;\n      }\n    }\n\n    // format inputs\n    const matches = [];\n    if (intolerances) {\n      var intoleranceLowerCase = intolerances.toLowerCase();\n      var newStrLowerCase = newStr.toLowerCase();\n      var strArray = newStrLowerCase.split(\" \");\n      var lowercaseOcrState = ocrState.array.map(index => {\n        return index.toLowerCase();\n      });\n    }\n\n    // console.log(`ocrState.array: ${ocrState.array}`)\n    // console.log(`str: ${str}`)\n    // console.log(`newStr: ${newStr}`)\n    // console.log(`newStrLowerCase: ${newStrLowerCase}`)\n    // console.log(`strArray: ${strArray}`)\n    // // str.includes(combination)\n    // console.log(`lowercaseOcrState: ${lowercaseOcrState}`)\n\n    // find matches\n    for (let i = 0; i < intoleranceArray.length; i++) {\n      for (let j = 0; j < strArray.length; j++) {\n        if (intoleranceArray[i] === strArray[j]) {\n          matches.push(intoleranceArray[i]);\n          break;\n        }\n      }\n    }\n\n    // highlight text\n    const highlighterReturn = [];\n    let key = 0;\n    for (let i = 0; i < matches.length; i++) {\n      for (let j = 0; j < lowercaseOcrState.length; j++) {\n        key += 1;\n        if (lowercaseOcrState[j].includes(matches[i])) {\n          highlighterReturn.push( /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"highlight\",\n            children: [\" \", matches[i].toUpperCase()]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this));\n          key += 1;\n          highlighterReturn.push( /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \",\"\n          }, key, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 34\n          }, this));\n        } else {\n          highlighterReturn.push(`${ocrState.array[j]} `);\n        }\n      }\n    }\n    if (matches[0] && !loading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"result_matches\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result_matches_warning\",\n          children: \"Results: Warning, this product contains harmful ingredients!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result_matches_text\",\n          children: highlighterReturn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this);\n    } else if (!matches[0] && !loading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"result_nomatches\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result_nomatches_warning\",\n          children: \"Results: This product is safe for consumption!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result_nomatches_text\",\n          children: ocrState.array.join(\" \")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"results\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-box\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"results\",\n        id: \"inner\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text_with_highlight\",\n          children: highlightText(intolerances, ocrState.text)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), matches && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"navigation\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary\",\n        onClick: backButton,\n        children: \"Scan again\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 5\n  }, this);\n}\n_s(ScanResult, \"H7CN6PnC2QKypjq3STAazSKETZ4=\");\n_c = ScanResult;\nvar _c;\n$RefreshReg$(_c, \"ScanResult\");","map":{"version":3,"names":["useState","useEffect","ScanResult","ocrState","confidence","intolerances","backButton","progress","loading","matches","setMatches","findMatches","str","newStr","validChars","intoleranceArray","split","i","length","char","indexOf","strArray","j","push","highlightText","intoleranceLowerCase","toLowerCase","newStrLowerCase","lowercaseOcrState","array","map","index","highlighterReturn","key","includes","toUpperCase","join","text"],"sources":["/Users/bradwilliams/EatSafely/client/src/pages/scan_result.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport \"./scan_result.scss\";\n\nexport default function ScanResult({\n  ocrState,\n  confidence,\n  intolerances,\n  backButton,\n  progress,\n  loading,\n}) {\n  const [matches, setMatches] = useState([]);\n\n  // useEffect(() => {\n  //   findMatches(intolerances, ocrState.text)\n  // }, [findMatches]);\n\n  function findMatches(intolerances, str) {\n    let matches = [];\n    let newStr = \"\";\n    let validChars =\n      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\n    let intoleranceArray = intolerances.split(\", \");\n\n    for (let i = 0; i < str.length; i++) {\n      let char = str[i];\n      if (validChars.indexOf(char) !== -1) {\n        newStr += char;\n      }\n    }\n\n    let strArray = newStr.split(\" \");\n    // console.log(`find matches: newStr ${newStr}`);\n    // console.log(`find matches: strArray ${strArray}`);\n    // console.log(`find matches: strArray ${typeof strArray}`);\n    // console.log(`find matches: intolerances - ${intoleranceArray}`)\n    // console.log(`find matches: intolerances - ${typeof intoleranceArray}`)\n\n    for (let i = 0; i < intoleranceArray.length; i++) {\n      for (let j = 0; j < strArray.length; j++) {\n        if (intoleranceArray[i] === strArray[j]) {\n          matches.push(intoleranceArray[i]);\n          break;\n        }\n      }\n    }\n\n    setMatches(matches);\n    return matches;\n  }\n\n  function highlightText(intolerances, str) {\n    // take out punctuation\n    let newStr = \"\";\n    const validChars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ \";\n    // /[A-Z]\\i/\n\n    for (let i = 0; i < str.length; i++) {\n      let char = str[i];\n      if (validChars.indexOf(char) !== -1) {\n        newStr += char;\n      }\n    }\n\n    // format inputs\n    const matches = [];\n    if (intolerances) {\n      var intoleranceLowerCase = intolerances.toLowerCase();\n      var newStrLowerCase = newStr.toLowerCase();\n      var strArray = newStrLowerCase.split(\" \");\n      var lowercaseOcrState = ocrState.array.map((index) => {\n        return index.toLowerCase();\n      });\n    }\n\n    // console.log(`ocrState.array: ${ocrState.array}`)\n    // console.log(`str: ${str}`)\n    // console.log(`newStr: ${newStr}`)\n    // console.log(`newStrLowerCase: ${newStrLowerCase}`)\n    // console.log(`strArray: ${strArray}`)\n    // // str.includes(combination)\n    // console.log(`lowercaseOcrState: ${lowercaseOcrState}`)\n\n    // find matches\n    for (let i = 0; i < intoleranceArray.length; i++) {\n      for (let j = 0; j < strArray.length; j++) {\n        if (intoleranceArray[i] === strArray[j]) {\n          matches.push(intoleranceArray[i]);\n          break;\n        }\n      }\n    }\n\n    // highlight text\n    const highlighterReturn = [];\n    let key = 0;\n    for (let i = 0; i < matches.length; i++) {\n      for (let j = 0; j < lowercaseOcrState.length; j++) {\n        key += 1;\n        if (lowercaseOcrState[j].includes(matches[i])) {\n          highlighterReturn.push(\n            <span className=\"highlight\" key={key}>\n              {\" \"}\n              {matches[i].toUpperCase()}\n            </span>\n          );\n          key += 1;\n          highlighterReturn.push(<span key={key}>,</span>);\n        } else {\n          highlighterReturn.push(`${ocrState.array[j]} `);\n        }\n      }\n    }\n\n    if (matches[0] && !loading) {\n      return (\n        <div className=\"result_matches\">\n          <div className=\"result_matches_warning\">\n            Results: Warning, this product contains harmful ingredients!\n          </div>\n          <div className=\"result_matches_text\">{highlighterReturn}</div>\n        </div>\n      );\n    } else if (!matches[0] && !loading) {\n      return (\n        <div className=\"result_nomatches\">\n          <div className=\"result_nomatches_warning\">\n            Results: This product is safe for consumption!\n          </div>\n          <div className=\"result_nomatches_text\">\n            {ocrState.array.join(\" \")}\n          </div>\n        </div>\n      );\n    }\n  }\n\n  return (\n    <main className=\"results\">\n      <div className=\"text-box\">\n        <span className=\"results\" id=\"inner\">\n          {/* {ocrState.text && <span> Results: {ocrState.text}</span>} */}\n          {/* {confidence > 55 && <span>High confidence : {confidence}%</span>} */}\n          <div className=\"text_with_highlight\">\n            {highlightText(intolerances, ocrState.text)}\n          </div>\n        </span>\n      </div>\n\n      {/* Scan new */}\n\n      {matches && (\n        <div className=\"navigation\">\n          <button\n            type=\"button\"\n            className=\"btn btn-primary\"\n            onClick={backButton}\n          >\n            Scan again\n          </button>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}